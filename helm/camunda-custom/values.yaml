# ============================================
# GLOBAL CONFIGURATION
# ============================================
global:
  # Auto-generate secrets za prvu instalaciju
  secrets:
    autoGenerated: true
    name: camunda-platform-secrets

  # OpenShift Security Context Constraints
  compatibility:
    openshift:
      adaptSecurityContext: force

  # OpenShift Routes (Ingress)
  ingress:
    enabled: true
    className: ""
    host: "camunda-platform.ostestdmz.branch.loc"
    tls:
      enabled: true
      secretName: <camunda-platform-tls-secret>  # TLS secret ime za rutu

  # EKSTERNI ELASTICSEARCH - HTTP (bez SSL)
  elasticsearch:
    enabled: true
    external: true
    auth:
      username: "camunda_user"
      existingSecret: elasticsearch-credentials
      existingSecretKey: password
    url:
      protocol: http  # HTTP - bez SSL
      host: "elastictst.branch.loc"
      port: 9200
    tls:
      enabled: false  # Bez SSL

  # Disable OpenSearch
  opensearch:
    enabled: false

  # Identity & Auth - RHBK Keycloak
  identity:
    auth:
      enabled: true
      type: KEYCLOAK
      
      # Javni URL za browser redirects (bez /auth jer je RHBK)
      publicIssuerUrl: "https://camunda-platform.ostestdmz.branch.loc/realms/camunda-platform"
      
      # Interno za pod-to-pod komunikaciju
      issuerBackendUrl: "http://camunda-platform-keycloak:80/realms/camunda-platform"
      tokenUrl: "http://camunda-platform-keycloak:80/realms/camunda-platform/protocol/openid-connect/token"
      jwksUrl: "http://camunda-platform-keycloak:80/realms/camunda-platform/protocol/openid-connect/certs"

      # Client credentials za Identity
      identity:
        clientId: "camunda-identity"
        existingSecret: "keycloak-client-secret"
        existingSecretKey: "identity-token"

      # Client credentials za Operate
      operate:
        clientId: "camunda-operate"
        existingSecret: "keycloak-client-secret"
        existingSecretKey: "operate-token"

      # Client credentials za Tasklist
      tasklist:
        clientId: "camunda-tasklist"
        existingSecret: "keycloak-client-secret"
        existingSecretKey: "tasklist-token"

      # Client credentials za Console
      console:
        clientId: "camunda-console"
        existingSecret: "keycloak-client-secret"
        existingSecretKey: "console-token"

      # Client credentials za Zeebe
      zeebe:
        clientId: "zeebe"
        existingSecret: "keycloak-client-secret"
        existingSecretKey: "zeebe-token"

    # Keycloak connection settings
    keycloak:
      url:
        protocol: http
        host: camunda-platform-keycloak
        port: 80
        # RHBK 22+ ne koristi /auth prefix
      realm: "camunda-platform"
      auth:
        adminUser: "admin"
        existingSecret: keycloak-admin-secret
        existingSecretKey: admin-password

# ============================================
# DISABLE EMBEDDED COMPONENTS
# ============================================
elasticsearch:
  enabled: false

postgresql:
  enabled: false

# ============================================
# KEYCLOAK (RHBK Operator managed)
# ============================================
identityKeycloak:
  enabled: true
  
  # Disable embedded PostgreSQL
  postgresql:
    enabled: false
  
  # Eksterni PostgreSQL
  externalDatabase:
    host: "postgresql-service.camunda-platform.svc.cluster.local"
    port: 5432
    database: "keycloak"  # Ime baze
    user: "keycloak_user"
    existingSecret: postgresql-keycloak-secret
    existingSecretPasswordKey: password
  
  # Keycloak admin credentials
  auth:
    adminUser: admin
    existingSecret: keycloak-admin-secret
    existingSecretPasswordKey: admin-password

  # OpenShift Route za Keycloak
  ingress:
    enabled: true
    ingressClassName: ""
    hostname: "camunda-platform.ostestdmz.branch.loc"
    tls: true
    # RHBK nema /auth prefix
    pathType: Prefix
    annotations:
      route.openshift.io/termination: "edge"

# ============================================
# IDENTITY
# ============================================
identity:
  enabled: true
  contextPath: /identity
  
  # Eksterni PostgreSQL
  externalDatabase:
    enabled: true
    host: "postgresql-service.camunda-platform.svc.cluster.local"
    port: 5432
    database: "identity"  # Ime baze
    username: "identity_user"
    existingSecret: postgresql-identity-secret
    existingSecretKey: password
  
  env:
    - name: CAMUNDA_LOG_FILE_APPENDER_ENABLED
      value: "false"

# ============================================
# ZEEBE (Orchestration Engine)
# ============================================
zeebe:
  enabled: true
  clusterSize: 3
  partitionCount: 3
  replicationFactor: 3
  
  # Data retention
  retention:
    enabled: true
    minimumAge: 30d
  
  # Resources
  resources:
    requests:
      cpu: "1"
      memory: "2Gi"
    limits:
      cpu: "2"
      memory: "4Gi"
  
  env:
    - name: CAMUNDA_LOG_FILE_APPENDER_ENABLED
      value: "false"

# ============================================
# ZEEBE GATEWAY
# ============================================
zeebe-gateway:
  enabled: true
  replicas: 2
  
  # Resources
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "1"
      memory: "2Gi"
  
  # gRPC Route za eksterne klijente (workers)
  ingress:
    enabled: true
    className: ""
    host: "zeebe-grpc.ostestdmz.branch.loc"
    tls:
      enabled: true
      secretName: <zeebe-grpc-tls-secret>  # TLS secret za gRPC rutu
  
  env:
    - name: CAMUNDA_LOG_FILE_APPENDER_ENABLED
      value: "false"

# ============================================
# OPERATE
# ============================================
operate:
  enabled: true
  replicas: 2
  contextPath: /operate
  
  # Resources
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "1"
      memory: "2Gi"
  
  env:
    - name: CAMUNDA_LOG_FILE_APPENDER_ENABLED
      value: "false"

# ============================================
# TASKLIST
# ============================================
tasklist:
  enabled: true
  replicas: 2
  contextPath: /tasklist
  
  # Resources
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "1"
      memory: "2Gi"
  
  env:
    - name: CAMUNDA_LOG_FILE_APPENDER_ENABLED
      value: "false"

# ============================================
# CONSOLE
# ============================================
console:
  enabled: true
  contextPath: /
  
  env:
    - name: CAMUNDA_LOG_FILE_APPENDER_ENABLED
      value: "false"

# ============================================
# CONNECTORS (disable ako ne koristiš)
# ============================================
connectors:
  enabled: false
  # Ako koristiš connectors:
  # enabled: true
  # Dodaj u Keycloak client: camunda-connectors
  # Dodaj u secret: connectors-token

# ============================================
# OPTIMIZE (disable - ne koristiš)
# ============================================
optimize:
  enabled: false

# ============================================
# WEB MODELER (disable - ne koristiš)
# ============================================
webModeler:
  enabled: false

webModelerPostgresql:
  enabled: false
